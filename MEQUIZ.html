<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz: MÃ©tabolisme & ATP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    
    <style>
        /* ================= GENERAL STYLES ================= */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            outline: none;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            min-height: 100vh;
            /* ØµÙˆØ±Ø© Ø®Ù„ÙÙŠØ© Ù‡Ø§Ø¯Ø¦Ø© */
            background-image: url("https://images.pexels.com/photos/9574577/pexels-photo-9574577.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2");
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            padding: 20px;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.5); /* ØªØ¹ØªÙŠÙ… Ù…ØªÙˆØ³Ø· */
            z-index: 0;
        }

        /* ================= MUSIC PLAYER STYLES (RE-DESIGNED) ================= */
        
        #player-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 350px; /* Ø­Ø¬Ù… Ø£ØµØºØ± ÙˆÙ…Ù†Ø§Ø³Ø¨ */
            height: 80px;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¬ÙˆØ§Ù„ */
        @media (max-width: 768px) {
            #player-container {
                width: 300px;
                right: 50%;
                transform: translateX(50%);
                bottom: 15px;
            }
            .glass-container {
                margin-bottom: 120px; /* Ù…Ø³Ø§ÙØ© Ù„ÙƒÙŠ Ù„Ø§ ÙŠØºØ·ÙŠ Ø§Ù„Ù…Ø´ØºÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙˆÙŠØ² */
            }
        }

        #player {
            position: relative;
            height: 100%;
            z-index: 3;
        }

        /* Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø¹Ù„ÙˆÙŠ (Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£ØºÙ†ÙŠØ©) */
        #player-track {
            position: absolute;
            top: 0;
            right: 15px;
            left: 15px;
            padding: 10px 10px 10px 110px; /* Ù…Ø³Ø§ÙØ© Ù„Ù„ØµÙˆØ±Ø© */
            /* Ø®Ù„ÙÙŠØ© Ø²Ø¬Ø§Ø¬ÙŠØ© Ø¯Ø§ÙƒÙ†Ø© */
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(10px);
            border-radius: 15px 15px 0 0;
            transition: 0.3s ease top;
            z-index: 1;
            border: 1px solid rgba(255,255,255,0.1);
            border-bottom: none;
        }

        #player-track.active {
            top: -75px; /* ÙŠØ±ØªÙØ¹ Ù„Ù„Ø£Ø¹Ù„Ù‰ Ø¹Ù†Ø¯ Ø§Ù„ØªØ´ØºÙŠÙ„ */
        }

        #track-name {
            color: white;
            font-size: 14px;
            font-weight: bold;
            margin: 2px 0 5px 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        #track-time {
            height: 12px;
            margin-bottom: 3px;
            overflow: hidden;
            display: flex;
            justify-content: space-between;
        }

        #current-time, #track-length {
            color: rgba(255,255,255,0.7);
            font-size: 10px;
            background-color: transparent;
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
        #seek-bar-container {
            position: relative;
            height: 4px;
            background-color: rgba(255,255,255,0.2);
            cursor: pointer;
            border-radius: 4px;
            margin-top: 5px;
        }

        #seek-bar {
            position: absolute;
            top: 0; bottom: 0; left: 0;
            width: 0;
            /* Ù„ÙˆÙ† Ø£Ø®Ø¶Ø± Ù…ØªÙ†Ø§Ø³Ù‚ Ù…Ø¹ Ø§Ù„ÙƒÙˆÙŠØ² */
            background-color: #2ecc71;
            box-shadow: 0 0 10px rgba(46, 204, 113, 0.5);
            transition: 0.2s ease width;
            border-radius: 4px;
            z-index: 1;
        }

        /* Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø³ÙÙ„ÙŠ (Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…) */
        #player-content {
            position: relative;
            height: 100%;
            /* Ø®Ù„ÙÙŠØ© Ø²Ø¬Ø§Ø¬ÙŠØ© ÙØ§ØªØ­Ø© */
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border-radius: 15px;
            border: 1px solid rgba(255,255,255,0.2);
            z-index: 2;
            display: flex;
            align-items: center;
        }

        /* ØµÙˆØ±Ø© Ø§Ù„Ø£Ù„Ø¨ÙˆÙ… */
        #album-art {
            position: absolute;
            top: -20px;
            left: 20px;
            width: 80px;
            height: 80px;
            transform: rotateZ(0);
            transition: 0.3s ease all;
            box-shadow: 0 0 0 5px rgba(255,255,255,0.1);
            border-radius: 50%;
            overflow: hidden;
            background: #000;
        }

        #album-art.active {
            top: -40px; /* ØªØ±ØªÙØ¹ Ù„Ù„Ø£Ø¹Ù„Ù‰ Ø¹Ù†Ø¯ Ø§Ù„ØªØ´ØºÙŠÙ„ */
            box-shadow: 0 0 0 5px rgba(46, 204, 113, 0.2), 0 10px 20px rgba(0,0,0,0.3);
        }

        #album-art img {
            width: 100%; height: 100%;
            object-fit: cover;
            opacity: 0.8;
        }

        #album-art.active img {
            opacity: 1;
            animation: rotateAlbumArt 6s linear infinite;
        }

        @keyframes rotateAlbumArt {
            0% { transform: rotateZ(0); }
            100% { transform: rotateZ(360deg); }
        }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… */
        #player-controls {
            width: 200px;
            height: 100%;
            margin-left: 110px; /* Ù…Ø³Ø§ÙØ© Ø¨Ø¹Ø¯ Ø§Ù„ØµÙˆØ±Ø© */
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .button {
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: rgba(255,255,255,0.1);
            border-radius: 50%;
            cursor: pointer;
            transition: 0.2s ease all;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .button i {
            color: white;
            font-size: 18px;
        }

        .button:hover {
            background-color: #2ecc71; /* ØªØ­ÙˆÙ„ Ù„Ù„Ø£Ø®Ø¶Ø± Ø¹Ù†Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ… */
            transform: scale(1.1);
            border-color: #2ecc71;
        }

        /* ================= QUIZ STYLES (UNCHANGED) ================= */
        .glass-container {
            position: relative;
            z-index: 10;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(25px) saturate(180%);
            -webkit-backdrop-filter: blur(25px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 30px;
            padding: 30px;
            width: 100%;
            max-width: 600px;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            min-height: 500px;
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .question-count {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.6);
            background: rgba(0,0,0,0.2);
            padding: 5px 12px;
            border-radius: 15px;
        }

        .score-display { font-weight: bold; color: #2ecc71; }

        #question-text {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 30px;
            line-height: 1.5;
            min-height: 60px;
        }

        .options-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 30px;
        }

        .option-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 15px 20px;
            border-radius: 15px;
            color: rgba(255, 255, 255, 0.9);
            text-align: left;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 15px;
            position: relative;
        }

        .option-btn:hover { background: rgba(255, 255, 255, 0.15); }
        .option-btn.selected {
            background: rgba(52, 152, 219, 0.2);
            border-color: #3498db;
            box-shadow: 0 0 15px rgba(52, 152, 219, 0.3);
        }

        .circle-check {
            width: 20px; height: 20px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.4);
            flex-shrink: 0;
            display: flex; align-items: center; justify-content: center;
        }
        
        .option-btn.selected .circle-check { background: #3498db; border-color: #3498db; }
        .option-btn.correct { background: rgba(46, 204, 113, 0.3) !important; border-color: #2ecc71 !important; }
        .option-btn.wrong { background: rgba(231, 76, 60, 0.3) !important; border-color: #e74c3c !important; }

        .controls {
            margin-top: auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .btn-action {
            padding: 12px 30px;
            border-radius: 20px;
            border: none;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .btn-action:active { transform: scale(0.95); }
        .btn-validate { background: #3498db; color: white; width: 100%; }
        .btn-next { background: #2ecc71; color: white; display: none; width: 100%; }

        .exit-btn {
            position: absolute;
            top: 20px; left: 20px;
            text-decoration: none;
            color: white;
            background: rgba(0,0,0,0.5);
            padding: 8px 15px;
            border-radius: 15px;
            font-size: 0.8rem;
            backdrop-filter: blur(5px);
            z-index: 20;
        }

        .result-screen {
            display: none;
            text-align: center;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
        }

        .final-score {
            font-size: 4rem;
            font-weight: 800;
            background: linear-gradient(45deg, #3498db, #2ecc71);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 20px 0;
        }

    </style>
</head>
<body>

    <a href="menu_metabolisme.html" class="exit-btn">â† Quitter</a>

    <div id="player-container">
        <div id="player">
            <div id="player-track">
                <div id="track-name">Loading...</div>
                <div id="track-time">
                    <div id="current-time">00:00</div>
                    <div id="track-length">00:00</div>
                </div>
                <div id="seek-bar-container">
                    <div id="seek-bar"></div>
                </div>
            </div>
            <div id="player-content">
                <div id="album-art">
                    <img src="https://images.pexels.com/photos/1762578/pexels-photo-1762578.jpeg?auto=compress&cs=tinysrgb&w=600" class="active" id="album-art-img">
                </div>
                <div id="player-controls">
                    <div class="button" id="play-previous">
                        <i class="fas fa-backward"></i>
                    </div>
                    <div class="button" id="play-pause-button">
                        <i class="fas fa-play"></i>
                    </div>
                    <div class="button" id="play-next">
                        <i class="fas fa-forward"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="glass-container">
        <div id="quiz-ui">
            <div class="quiz-header">
                <span class="question-count">Question <span id="current-q">1</span>/20</span>
                <span class="score-display">Score: <span id="score">0</span></span>
            </div>
            <div id="question-text">Chargement de la question...</div>
            <div class="options-grid" id="options-container"></div>
            <div class="controls">
                <button class="btn-action btn-validate" onclick="checkAnswer()">Valider</button>
                <button class="btn-action btn-next" onclick="nextQuestion()">Suivant</button>
            </div>
            <p style="text-align: center; font-size: 0.8rem; opacity: 0.5; margin-top: 10px;">
                âš ï¸ SÃ©lectionnez TOUTES les bonnes rÃ©ponses.
            </p>
        </div>

        <div id="result-ui" class="result-screen">
            <h2>Quiz TerminÃ© !</h2>
            <p>Votre maÃ®trise du mÃ©tabolisme :</p>
            <div class="final-score" id="final-score-display">0/20</div>
            <p id="feedback-text" style="margin-bottom: 30px; opacity: 0.8;"></p>
            <button class="btn-action btn-validate" onclick="location.reload()">Recommencer</button>
            <br>
            <a href="menu_metabolisme.html" style="color:white; opacity: 0.7; margin-top: 15px; display:inline-block;">Retour au Menu</a>
        </div>
    </div>

    <script>
        /* ================= MUSIC PLAYER LOGIC ================= */
        const tracks = [
        { name: "RilÃ¨s - DAMNED?", url: "https://github.com/oussamaelbahi2004/sher/raw/main/WhatsApp%20Video%202026-01-03%20at%201.59.04%20PM.mp4" },
            { name: "RilÃ¨s - PESETAS", url: "https://github.com/oussamaelbahi2004/sher/raw/main/WhatsApp%20Video%202026-01-03%20at%201.46.49%20PM.mp4" },
            { name: "RilÃ¨s - LOST IN MY WORLD", url: "https://github.com/oussamaelbahi2004/sher/raw/main/WhatsApp%20Video%202026-01-03%20at%201.44.56%20PM.mp4" }
        ];

        const audio = new Audio();
        let currentTrackIndex = 0;
        let isPlaying = false;

        // UI Elements
        const playPauseBtn = document.getElementById('play-pause-button');
        const playPauseIcon = playPauseBtn.querySelector('i');
        const nextBtn = document.getElementById('play-next');
        const prevBtn = document.getElementById('play-previous');
        const trackNameEl = document.getElementById('track-name');
        const albumArt = document.getElementById('album-art');
        const playerTrack = document.getElementById('player-track');
        const seekBar = document.getElementById('seek-bar');
        const currentTimeEl = document.getElementById('current-time');
        const trackLengthEl = document.getElementById('track-length');

        function initPlayer() {
            audio.src = tracks[currentTrackIndex].url;
            trackNameEl.textContent = tracks[currentTrackIndex].name;
            audio.loop = false;
        }

        function playTrack() {
            audio.play().then(() => {
                isPlaying = true;
                playPauseIcon.className = 'fas fa-pause';
                albumArt.classList.add('active');
                playerTrack.classList.add('active');
            }).catch(e => console.log("Autoplay blocked"));
        }

        function pauseTrack() {
            audio.pause();
            isPlaying = false;
            playPauseIcon.className = 'fas fa-play';
            albumArt.classList.remove('active');
            playerTrack.classList.remove('active');
        }

        function nextTrack() {
            currentTrackIndex = (currentTrackIndex + 1) % tracks.length;
            initPlayer();
            if(isPlaying) playTrack();
        }

        function prevTrack() {
            currentTrackIndex = (currentTrackIndex - 1 + tracks.length) % tracks.length;
            initPlayer();
            if(isPlaying) playTrack();
        }

        function formatTime(s) {
            let min = Math.floor(s / 60);
            let sec = Math.floor(s % 60);
            if (min < 10) min = "0" + min;
            if (sec < 10) sec = "0" + sec;
            return min + ":" + sec;
        }

        // Listeners
        playPauseBtn.addEventListener('click', () => {
            if (isPlaying) pauseTrack();
            else playTrack();
        });

        nextBtn.addEventListener('click', nextTrack);
        prevBtn.addEventListener('click', prevTrack);

        audio.addEventListener('timeupdate', () => {
            if(audio.duration) {
                const position = audio.currentTime / audio.duration;
                seekBar.style.width = (position * 100) + '%';
                currentTimeEl.textContent = formatTime(audio.currentTime);
                trackLengthEl.textContent = formatTime(audio.duration);
            }
        });

        audio.addEventListener('ended', nextTrack);

        // Init
        initPlayer();
        window.addEventListener('load', () => {
            playTrack(); // Attempt autoplay
        });

        /* ================= QUIZ LOGIC (Standard) ================= */
        const fullQuestionPool = [
            { q: "L'hydrolyse de l'ATP est une rÃ©action :", o: ["Exergonique (LibÃ¨re de l'Ã©nergie)", "Endergonique (Consomme de l'Ã©nergie)", "Qui produit de l'ADP et du Pi", "Qui nÃ©cessite de l'ATP synthase"], a: [0, 2] },
            { q: "Concernant la Glycolyse :", o: ["Elle se dÃ©roule dans la matrice mitochondriale", "C'est une Ã©tape aÃ©robie stricte", "Elle produit 2 ATP nets", "Elle rÃ©duit 2 NAD+ en NADH,H+"], a: [2, 3] },
            { q: "Quels sont les produits finaux de la glycolyse pour une molÃ©cule de glucose ?", o: ["2 Pyruvates", "2 Acetyl-CoA", "2 ATP", "2 NADH,H+"], a: [0, 2, 3] },
            { q: "La structure de la mitochondrie comprend :", o: ["Une membrane externe permÃ©able", "Des thylakoÃ¯des", "Une matrice riche en enzymes", "Des crÃªtes mitochondriales"], a: [0, 2, 3] },
            { q: "L'Ã©tape de formation de l'Acetyl-CoA :", o: ["Se dÃ©roule dans le hyaloplasme", "Se dÃ©roule dans la matrice", "Produit du CO2", "Produit de l'ATP directement"], a: [1, 2] },
            { q: "Le Cycle de Krebs :", o: ["Se dÃ©roule dans l'espace intermembranaire", "LibÃ¨re 2 CO2 par tour de cycle", "Produit 3 NADH,H+ par tour", "Produit 1 FADH2 par tour"], a: [1, 2, 3] },
            { q: "Le bilan Ã©nergÃ©tique d'un tour de cycle de Krebs est de :", o: ["1 ATP", "12 ATP (aprÃ¨s phosphorylation oxydative)", "3 ATP", "15 ATP"], a: [0, 1] },
            { q: "La chaÃ®ne respiratoire :", o: ["Est situÃ©e dans la membrane externe", "Est situÃ©e dans la membrane interne (crÃªtes)", "Permet l'oxydation de NADH,H+ et FADH2", "Accepte les Ã©lectrons de l'O2"], a: [1, 2] },
            { q: "Lors de la phosphorylation oxydative, les protons H+ :", o: ["Sont pompÃ©s vers la matrice", "Sont pompÃ©s vers l'espace intermembranaire", "Retournent vers la matrice via l'ATP Synthase", "Traversent la membrane externe"], a: [1, 2] },
            { q: "L'accepteur final des Ã©lectrons dans la chaÃ®ne respiratoire est :", o: ["Le NAD+", "L'ATP Synthase", "Le DioxygÃ¨ne (O2)", "Le Cytochrome C"], a: [2] },
            { q: "L'oxydation complÃ¨te d'une molÃ©cule de Glucose produit thÃ©oriquement :", o: ["2 ATP", "32 ATP", "36 Ã  38 ATP", "12 ATP"], a: [2] },
            { q: "La fermentation lactique :", o: ["Produit du CO2", "Ne produit pas de CO2", "Transforme le pyruvate en lactate", "A lieu dans la mitochondrie"], a: [1, 2] },
            { q: "La fermentation alcoolique :", o: ["Produit de l'Ã©thanol", "LibÃ¨re du CO2", "Se dÃ©roule dans le hyaloplasme", "Produit 36 ATP"], a: [0, 1, 2] },
            { q: "Le rendement Ã©nergÃ©tique :", o: ["De la respiration est supÃ©rieur Ã  celui de la fermentation", "De la fermentation est d'environ 2%", "De la respiration est d'environ 40%", "Est identique pour les deux voies"], a: [0, 1, 2] },
            { q: "L'ATP Synthase (SphÃ¨re pÃ©donculÃ©e) :", o: ["Est une enzyme de la glycolyse", "Utilise le gradient de protons pour produire de l'ATP", "Est situÃ©e dans la membrane interne mitochondriale", "Pompe les H+ vers l'espace intermembranaire"], a: [1, 2] },
            { q: "La rÃ©duction de l'oxygÃ¨ne en eau nÃ©cessite :", o: ["2 Ã©lectrons", "4 Ã©lectrons pour une molÃ©cule O2", "Des protons H+", "De l'ATP"], a: [1, 2] },
            { q: "Les transporteurs d'Ã©lectrons rÃ©duits sont :", o: ["NAD+", "FAD", "NADH,H+", "FADH2"], a: [3, 2] },
            { q: "Le gradient de protons (H+) :", o: ["Signifie que le pH est plus acide dans la matrice", "Signifie que le pH est plus acide dans l'espace intermembranaire", "Est une forme d'Ã©nergie potentielle", "Est crÃ©Ã© par les complexes I, III et IV"], a: [1, 2, 3] },
            { q: "Une cellule musculaire en manque d'oxygÃ¨ne va faire :", o: ["La fermentation alcoolique", "La fermentation lactique", "Le cycle de Krebs", "La glycolyse uniquement"], a: [1, 4] },
            { q: "Le pyruvate :", o: ["Est un C3 (3 carbones)", "Est un C2 (2 carbones)", "Doit entrer dans la mitochondrie pour Ãªtre respirÃ©", "Est le produit final du cycle de Krebs"], a: [0, 2] },
            { q: "Concernant les sphÃ¨res pÃ©donculÃ©es :", o: ["Elles regardent vers la matrice", "Elles regardent vers l'espace intermembranaire", "Elles synthÃ©tisent l'ATP", "Elles hydrolysent l'ATP"], a: [0, 2] },
            { q: "L'oxydation du NADH,H+ au niveau de la chaÃ®ne respiratoire permet de produire :", o: ["2 ATP", "3 ATP", "1 ATP", "Aucun ATP"], a: [1] },
            { q: "L'oxydation du FADH2 permet de produire :", o: ["2 ATP", "3 ATP", "1.5 ATP", "Aucun ATP"], a: [0] },
            { q: "La premiÃ¨re Ã©tape de la glycolyse (activation du glucose) :", o: ["Produit de l'ATP", "Consomme de l'ATP", "Est une phosphorylation", "Est une dÃ©carboxylation"], a: [1, 2] },
            { q: "Le bilan chimique global de la respiration est :", o: ["C6H12O6 + 6O2 â†’ 6CO2 + 6H2O + E", "C6H12O6 â†’ 2 Ethanol + 2CO2", "C6H12O6 â†’ 2 Lactate", "6CO2 + 6H2O â†’ C6H12O6 + 6O2"], a: [0] },
            { q: "Les rÃ©actions de dÃ©carboxylation (perte de CO2) ont lieu pendant :", o: ["La glycolyse", "La formation de l'Acetyl-CoA", "Le cycle de Krebs", "La phosphorylation oxydative"], a: [1, 2] },
            { q: "Le cyanure bloque la chaÃ®ne respiratoire. La consÃ©quence immÃ©diate est :", o: ["ArrÃªt de la consommation d'O2", "ArrÃªt de la production d'ATP mitochondrial", "ArrÃªt du cycle de Krebs par manque de NAD+", "Augmentation de la fermentation"], a: [0, 1, 2, 3] },
            { q: "Le hyaloplasme contient :", o: ["Les enzymes de la glycolyse", "Les enzymes du cycle de Krebs", "Des nutriments (glucose)", "Des ribosomes"], a: [0, 2, 3] },
            { q: "La membrane interne de la mitochondrie est :", o: ["PermÃ©able aux H+", "ImpermÃ©able aux H+ (sauf via ATP Synthase)", "Riche en protÃ©ines", "Lisse"], a: [1, 2] },
            { q: "Lors de la fermentation alcoolique, l'accepteur final d'Ã©lectrons est :", o: ["L'oxygÃ¨ne", "L'acÃ©taldÃ©hyde (Ethanol)", "Le pyruvate", "Le NAD+"], a: [1] },
            { q: "La glycolyse est une voie mÃ©tabolique :", o: ["Commune Ã  la respiration et Ã  la fermentation", "SpÃ©cifique Ã  la respiration", "Qui se dÃ©roule sans oxygÃ¨ne", "Qui libÃ¨re toute l'Ã©nergie du glucose"], a: [0, 2] },
            { q: "Pour rÃ©gÃ©nÃ©rer le NAD+ nÃ©cessaire Ã  la glycolyse en anaÃ©robiose, la cellule utilise :", o: ["La chaÃ®ne respiratoire", "La fermentation", "Le cycle de Krebs", "L'ATP synthase"], a: [1] },
            { q: "Un acide gras peut-il entrer dans la respiration cellulaire ?", o: ["Non, seul le glucose est utilisÃ©", "Oui, sous forme d'Acetyl-CoA", "Oui, il entre directement dans la glycolyse", "Oui, mais le rendement est faible"], a: [1] },
            { q: "Combien de CO2 sont libÃ©rÃ©s pour une molÃ©cule de Glucose lors de la respiration complÃ¨te ?", o: ["2", "4", "6", "38"], a: [2] },
            { q: "Le complexe enzymatique responsable de la synthÃ¨se d'ATP s'appelle :", o: ["ATP Hydrolyse", "ATP Synthase", "ATP PolymÃ©rase", "ATP TransfÃ©rase"], a: [1] },
            { q: "Le rÃ´le de l'oxygÃ¨ne dans la respiration est :", o: ["De fournir de l'Ã©nergie", "De rÃ©cupÃ©rer les Ã©lectrons et les protons en fin de chaÃ®ne", "D'oxyder le glucose directement", "De transporter l'ATP"], a: [1] },
            { q: "La chaleur dÃ©gagÃ©e lors de l'activitÃ© musculaire provient :", o: ["Du rendement Ã©nergÃ©tique non total (perte)", "De la friction des muscles", "De l'hydrolyse de l'ATP", "De la fermentation uniquement"], a: [0, 2] },
            { q: "Les navettes (Shuttles) servent Ã  :", o: ["Transporter l'ATP hors de la mitochondrie", "Transporter les Ã©lectrons du NADH hyaloplasmique vers la mitochondrie", "Transporter le glucose", "Transporter l'Acetyl-CoA"], a: [1] },
            { q: "Si on injecte du Glucose directement dans une mitochondrie isolÃ©e :", o: ["Il y a production d'ATP", "Il ne se passe rien (pas d'enzymes de glycolyse)", "Il y a consommation d'O2", "Le glucose est transformÃ© en pyruvate"], a: [1] },
            { q: "Si on injecte du Pyruvate dans une mitochondrie isolÃ©e en prÃ©sence d'O2 :", o: ["Il y a production d'ATP", "Il ne se passe rien", "Il y a consommation d'O2", "Il y a dÃ©gagement de CO2"], a: [0, 2, 3] },
            { q: "La diffÃ©rence de pH de part et d'autre de la membrane interne mitochondriale est due :", o: ["Au cycle de Krebs", "Au pompage des protons par la chaÃ®ne respiratoire", "A l'ATP synthase", "A la glycolyse"], a: [1] },
            { q: "Une molÃ©cule de FADH2 cÃ¨de ses Ã©lectrons au niveau du :", o: ["Complexe I", "Complexe II", "Complexe III", "Coenzyme Q"], a: [1] },
            { q: "Le cyanure se fixe sur :", o: ["L'ATP synthase", "Le complexe IV (Cytochrome oxydase)", "Le transporteur T", "L'ubiquinone"], a: [1] },
            { q: "En absence d'O2, la chaÃ®ne respiratoire :", o: ["S'accÃ©lÃ¨re", "S'arrÃªte", "Fonctionne au ralenti", "Inverse son sens"], a: [1] },
            { q: "La chaleur retardÃ©e aprÃ¨s une secousse musculaire est due Ã  :", o: ["La reconstitution des rÃ©serves Ã©nergÃ©tiques", "La glycolyse", "La contraction elle-mÃªme", "Le relÃ¢chement"], a: [0] },
            { q: "Le rendement Ã©nergÃ©tique se calcule par :", o: ["(Energie stockÃ©e dans ATP / Energie du Glucose) x 100", "(Energie Glucose / Energie ATP) x 100", "Nombre d'ATP x 30.5 kJ", "Energie perdue en chaleur"], a: [0] },
            { q: "Le bilan en ATP de la fermentation alcoolique pour 1 glucose est de :", o: ["2 ATP", "4 ATP", "36 ATP", "0 ATP"], a: [0] },
            { q: "Lequel n'est PAS une Ã©tape de la respiration ?", o: ["Glycolyse", "Cycle de Calvin", "Cycle de Krebs", "Phosphorylation oxydative"], a: [1] },
            { q: "Les rÃ©actions d'oxydorÃ©duction impliquent :", o: ["Un transfert de protons uniquement", "Un transfert d'Ã©lectrons", "Un gain d'Ã©lectrons pour l'oxydant", "Une perte d'Ã©lectrons pour le rÃ©ducteur"], a: [1, 2, 3] },
            { q: "Le NAD+ est la forme :", o: ["OxydÃ©e", "RÃ©duite", "Riche en Ã©nergie", "Pauvre en Ã©nergie (relativement)"], a: [0, 3] }
        ];

        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let userSelection = [];

        function initQuiz() {
            currentQuestions = fullQuestionPool.sort(() => 0.5 - Math.random()).slice(0, 20);
            currentQuestionIndex = 0;
            score = 0;
            updateUI();
            showQuestion();
        }

        function updateUI() {
            document.getElementById('current-q').innerText = currentQuestionIndex + 1;
            document.getElementById('score').innerText = score;
        }

        function showQuestion() {
            const qData = currentQuestions[currentQuestionIndex];
            document.getElementById('question-text').innerText = qData.q;
            
            let tempOptions = qData.o.map((opt, index) => ({ text: opt, originalIndex: index }));
            tempOptions.sort(() => 0.5 - Math.random());

            const container = document.getElementById('options-container');
            container.innerHTML = '';
            userSelection = []; 

            tempOptions.forEach((optObj) => {
                const btn = document.createElement('div');
                btn.className = 'option-btn';
                btn.innerHTML = `<div class="circle-check"></div><span>${optObj.text}</span>`;
                btn.dataset.originalIndex = optObj.originalIndex;
                btn.onclick = () => toggleSelection(btn, optObj.originalIndex);
                container.appendChild(btn);
            });

            document.querySelector('.btn-validate').style.display = 'block';
            document.querySelector('.btn-next').style.display = 'none';
        }

        function toggleSelection(btnElement, originalIndex) {
            if(document.querySelector('.btn-next').style.display === 'block') return;
            if (userSelection.includes(originalIndex)) {
                userSelection = userSelection.filter(i => i !== originalIndex);
                btnElement.classList.remove('selected');
            } else {
                userSelection.push(originalIndex);
                btnElement.classList.add('selected');
            }
        }

        function checkAnswer() {
            if (userSelection.length === 0) return; 

            const qData = currentQuestions[currentQuestionIndex];
            const correctIndices = qData.a.sort();
            const userIndices = userSelection.sort();
            const isCorrect = JSON.stringify(correctIndices) === JSON.stringify(userIndices);

            const buttons = document.querySelectorAll('.option-btn');
            buttons.forEach(btn => {
                const idx = parseInt(btn.dataset.originalIndex);
                btn.classList.remove('selected');
                if (correctIndices.includes(idx)) {
                    btn.classList.add('correct');
                    btn.querySelector('.circle-check').innerText = 'âœ“';
                    btn.querySelector('.circle-check').style.borderColor = 'transparent';
                } else if (userIndices.includes(idx) && !correctIndices.includes(idx)) {
                    btn.classList.add('wrong');
                    btn.querySelector('.circle-check').innerText = 'âœ•';
                    btn.querySelector('.circle-check').style.borderColor = 'transparent';
                }
            });

            if (isCorrect) {
                score++;
                updateUI();
            }
            document.querySelector('.btn-validate').style.display = 'none';
            document.querySelector('.btn-next').style.display = 'block';
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < 20) {
                showQuestion();
                updateUI();
            } else {
                endQuiz();
            }
        }

        function endQuiz() {
            document.getElementById('quiz-ui').style.display = 'none';
            document.getElementById('result-ui').style.display = 'flex';
            document.getElementById('final-score-display').innerText = score + "/20";
            let feedback = score === 20 ? "INCROYABLE ! ğŸ§¬" : score >= 15 ? "Excellent ! ğŸ”¥" : "Courage ! ğŸ’ª";
            document.getElementById('feedback-text').innerText = feedback;
        }

        initQuiz();
    </script>
</body>
</html>